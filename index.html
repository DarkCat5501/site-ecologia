<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="./style.css"/>
</head>
<body>
	<script>
		const link="https://docs.google.com/document/d/15shFR1VnEkFYkt_T7HS9tYhvC5EQ6xufzNHX5hn_L0M/export?format=html"

		function getClassDelimiter(text){
			const delimiterR = new RegExp(/&<([^>.]*)+>/);
			const result = delimiterR.exec(text);
			if(result) return result[1]
			return false;
		}

		fetch(link).then(result => {
			console.log(result)
			result.text().then(data => {
				r = document.createElement("html")
				r.innerHTML = data;

				for(let node of r.childNodes){
					switch(node.tagName){
						// case "HEAD":
						// 	//TODO: clone styles
						// 	// for(let header of node.childNodes){
						// 	// 	switch(header.tagName){
						// 	// 		case "STYLE":
						// 	// 			document.head.appendChild(header);
						// 	// 			break;
						// 	// 		default: console.log("unwanted header",header.tagName,header)
						// 	// 	}
						// 	// }
						// 	//find styles	
						// 	break;
						case "BODY":

							const content = [document.body];

							for(let body of node.children){
								//clonar conteÃºdo
								const text = body.textContent;

								const delim =getClassDelimiter(text);
								if(delim !== false){
									if(delim){
										const newDiv = document.createElement("div");
										newDiv.classList.add(delim)
										content[content.length-1].appendChild(newDiv);
										content.push(newDiv)
									} else if (content.length>1){ content.pop() }
									else {
										const error = document.createElement("span")
										error.classList.add("error")
										error.textContent = "final inesperado de delimitador"
										content[content.length-1].appendChild(error);
									}
								} else {
									const element = body.cloneNode(true)
									content[content.length-1].appendChild(element)
								}
							}
							break;
					}
				}	
			})
		})
	</script>
		
</body>
</html>